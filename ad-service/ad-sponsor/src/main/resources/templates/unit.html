<!DOCTYPE html><html><head>    <!-- 页面meta -->    <meta charset="utf-8">    <meta http-equiv="X-UA-Compatible" content="IE=edge">    <title>广告投放平台</title>    <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport">    <!-- 引入样式 -->    <link rel="stylesheet" href="../static/plugins/elementui/index.css">    <link rel="stylesheet" href="../static/plugins/font-awesome/css/font-awesome.min.css">    <link rel="stylesheet" href="../static/css/style.css"></head><body class="hold-transition"><div id="app">    <div class="content-header">        <h1>推广单元列表</h1>    </div>    <div class="app-container">        <div class="box">            <!--顶栏-->            <div class="filter-container">                <el-col :span="20">                    <el-button type="primary" class="butT" @click="getAll()">主页</el-button>                    <el-button type="primary" class="butT" @click="addAdBTN()">为选中单元添加广告</el-button>                </el-col>            </div>            <!--主体信息展示-->            <el-table size="small" current-row-key="id" :data="dataList" stripe highlight-current-row                      @selection-change="handleSelectionChange">                <el-table-column type="index" align="center" label="序号" width="50"></el-table-column>                <el-table-column type="selection" align="center"></el-table-column>                <el-table-column prop="unitName" label="推广单元名" align="center"></el-table-column>                <el-table-column prop="positionType" label="位置类型" align="center"></el-table-column>                <el-table-column prop="budget" label="预算(单位：元)" align="center"></el-table-column>                <el-table-column label="操作" align="center">                    <template slot-scope="scope">                        <el-button type="primary" size="mini" @click="addUnitKeywordBTN(scope.row)">添加关键词限制</el-button>                    </template>                </el-table-column>                <el-table-column label="操作" align="center">                    <template slot-scope="scope">                        <el-button type="primary" size="mini" @click="addUnitDistrictBTN(scope.row)">添加地域限制</el-button>                    </template>                </el-table-column>                <el-table-column label="操作" align="center">                    <template slot-scope="scope">                        <el-button type="primary" size="mini" @click="addUnitItBTN(scope.row)">添加兴趣限制</el-button>                    </template>                </el-table-column>                <!--                查看所有广告-->                <el-table-column label="操作" align="center">                    <template slot-scope="scope">                        <el-button type="primary" size="mini" @click="showAllAdBTN(scope.row)">查看所有广告</el-button>                    </template>                </el-table-column>            </el-table>            <!--添加关键词限制-->            <div class="add-form">                <el-dialog title="添加关键词限制" :visible.sync="addUnitKeywordFormVisible">                    <el-form ref="addUnitKeywordForm" :model="addUnitKeywordDate" label-width="100px">                        <el-row>                            <el-col :span="12">                                <el-form-item label="关键词" prop="title">                                    <el-input v-model="addUnitKeywordDate.keyword"/>                                </el-form-item>                            </el-col>                        </el-row>                    </el-form>                    <div slot="footer" class="dialog-footer">                        <el-button @click="cancel()">取消</el-button>                        <el-button type="primary" @click="handleAddUnitKeyword()">添加</el-button>                    </div>                </el-dialog>            </div>            <!--添加地域限制-->            <div class="add-form">                <el-dialog title="添加地域限制" :visible.sync="addUnitDistrictFormVisible">                    <el-form ref="addUnitDistrictForm" :model="addUnitDistrictDate" label-position="right"                             label-width="100px">                        <el-row>                            <el-col :span="12">                                <el-form-item label="城市" prop="title">                                    <el-input v-model="addUnitDistrictDate.city"/>                                </el-form-item>                            </el-col>                        </el-row>                        <el-row>                            <el-col :span="12">                                <el-form-item label="省份" prop="title">                                    <el-input v-model="addUnitDistrictDate.province"/>                                </el-form-item>                            </el-col>                        </el-row>                    </el-form>                    <div slot="footer" class="dialog-footer">                        <el-button @click="cancel()">取消</el-button>                        <el-button type="primary" @click="handleAddUnitDistrict()">添加</el-button>                    </div>                </el-dialog>            </div>            <!--添加兴趣限制-->            <div class="add-form">                <el-dialog title="添加兴趣限制" :visible.sync="addUnitInterestFormVisible">                    <el-form ref="addUnitInterestForm" :model="addUnitInterestDate" label-position="right"                             label-width="100px">                        <el-row>                            <el-col :span="12">                                <el-form-item label="兴趣" prop="title">                                    <el-input v-model="addUnitInterestDate.itTag"/>                                </el-form-item>                            </el-col>                        </el-row>                    </el-form>                    <div slot="footer" class="dialog-footer">                        <el-button @click="cancel()">取消</el-button>                        <el-button type="primary" @click="handleAddUnitInterest()">添加</el-button>                    </div>                </el-dialog>            </div>            <!--新建广告-->            <div class="add-form">                <el-dialog title="新建广告" :visible.sync="addAdFormVisible">                    <el-form ref="addAdDate" :model="addAdDate" label-position="right"                             label-width="100px">                        <!--                        名称-->                        <el-row>                            <el-col :span="12">                                <el-form-item label="广告名" prop="title">                                    <el-input v-model="addAdDate.name"/>                                </el-form-item>                            </el-col>                        </el-row>                        <el-row>                            <el-col :span="12">                                <el-form-item label="类型" prop="title">                                    <el-cascader                                            v-model="addAdCascaderValue"                                            :options="addAdCascaderOptions"                                            @change="handleCascaderChange()">                                    </el-cascader>                                </el-form-item>                            </el-col>                        </el-row>                        <!--                        高度-->                        <el-row>                            <el-col :span="12">                                <el-form-item label="高度" prop="title">                                    <el-input v-model="addAdDate.height"/>                                </el-form-item>                            </el-col>                        </el-row>                        <!--                        宽度-->                        <el-row>                            <el-col :span="12">                                <el-form-item label="宽度" prop="title">                                    <el-input v-model="addAdDate.width"/>                                </el-form-item>                            </el-col>                        </el-row>                        <!--                        大小-->                        <el-row>                            <el-col :span="12">                                <el-form-item label="大小" prop="title">                                    <el-input v-model="addAdDate.size"/>                                </el-form-item>                            </el-col>                        </el-row>                        <!--                        持续时长-->                        <el-row>                            <el-col :span="12">                                <el-form-item label="持续时长" prop="title">                                    <el-input v-model="addAdDate.duration"/>                                </el-form-item>                            </el-col>                        </el-row>                        <!--                        URL地址-->                        <el-row>                            <el-col :span="12">                                <el-form-item label="URL地址" prop="title">                                    <el-input v-model="addAdDate.url"/>                                </el-form-item>                            </el-col>                        </el-row>                    </el-form>                    <div slot="footer" class="dialog-footer">                        <el-button @click="cancel()">取消</el-button>                        <el-button type="primary" @click="handleAddAd()">添加</el-button>                    </div>                </el-dialog>            </div>        </div>    </div></div></body><!-- 引入组件库 --><script src="../static/js/vue.js"></script><script src="../static/plugins/elementui/index.js"></script><script type="text/javascript" src="../static/js/jquery.min.js"></script><script src="../static/js/axios-0.18.0.js"></script><script>    var vue = new Vue({        el: '#app',        data: {            userId: 15,            dataList: [],//当前页要展示的列表数据            addUnitKeywordFormVisible: false,            addUnitDistrictFormVisible: false,            addUnitInterestFormVisible: false,            addAdFormVisible: false,            addUnitKeywordDate: {},            addUnitDistrictDate: {},            addUnitInterestDate: {},            addAdDate: {},            multipleSelection: [],            newAdId: 0,            creativeUnits: [],            addAdCascaderValue: [],//级联选择器            addAdCascaderOptions: [{                value: '1',                label: '图片',                children: [{                    value: '1',                    label: 'jpg',                },{                    value: '2',                    label: 'bmp',                }],            },{                value: '2',                label: '视频',                children: [{                    value: '3',                    label: 'mp4',                },{                    value: '4',                    label: 'avi',                }],            },{                value: '3',                label: '文本',                children: [{                    value: '5',                    label: 'txt',                }],            }]        },        //钩子函数，VUE对象初始化完成后自动执行        created() {            console.log("钩来！")            this.getAll()        },        methods: {            handleCascaderChange(){            },            showAllAdBTN(row) {                window.open("/ad-sponsor/adPage/" + row.id)            },            //选择变化时触发            handleSelectionChange(val) {                this.multipleSelection = val;            },            getAll() {                var arr = location.href.split("/");                axios.post("/ad-sponsor/get/adUnit/" + arr[arr.length - 1])                    .then(resp => {                        this.dataList = resp.data.data;                    })            },            //【操作】添加地域限制            addUnitDistrictBTN(row) {                this.addUnitDistrictFormVisible = true                this.addUnitDistrictDate.unitId = row.id            },            //【操作】添加关键词限制            addUnitKeywordBTN(row) {                this.addUnitKeywordFormVisible = true                this.addUnitKeywordDate.unitId = row.id            },            //【操作】添加兴趣限制            addUnitItBTN(row) {                this.addUnitInterestFormVisible = true                this.addUnitInterestDate.unitId = row.id            },            //处理【添加关键词限制】            handleAddUnitKeyword() {                axios.post("/ad-sponsor/create/unitKeyword", {                    unitKeywords: [this.addUnitKeywordDate]                }).then(resp => {                    if (resp.data.code === 0) {                        this.$message.success(resp.data.message)//显示成功提示                        this.addUnitKeywordFormVisible = false;//关闭窗口                        this.getAll();//刷新页面                    } else {                        this.$message.error(resp.data.message)//显示失败提示                    }                })            },            //处理【添加地域限制】            handleAddUnitDistrict() {                axios.post("/ad-sponsor/create/unitDistrict", {                    unitDistricts: [this.addUnitDistrictDate]                }).then(resp => {                    if (resp.data.code === 0) {                        this.$message.success(resp.data.message)//显示成功提示                        this.addUnitDistrictFormVisible = false;//关闭窗口                        this.getAll();//刷新页面                    } else {                        this.$message.error(resp.data.message)//显示失败提示                    }                })            },            //处理【添加兴趣限制】            handleAddUnitInterest() {                axios.post("/ad-sponsor/create/unitIt", {                    unitIts: [this.addUnitInterestDate]                }).then(resp => {                    if (resp.data.code === 0) {                        this.$message.success(resp.data.message)//显示成功提示                        this.addUnitInterestFormVisible = false;//关闭窗口                        this.getAll();//刷新页面                    } else {                        this.$message.error(resp.data.message)//显示失败提示                    }                })            },            //【顶栏】创建广告            addAdBTN() {                this.resetForm()                this.addAdFormVisible = true            },            async handleAddAd() {                //添加广告                await axios.post("/ad-sponsor/create/creative", {                    name: this.addAdDate.name,                    type:this.addAdCascaderValue[0],                    materialType:this.addAdCascaderValue[1],                    height:this.addAdDate.height,                    width:this.addAdDate.width,                    size:this.addAdDate.size,                    duration:this.addAdDate.duration,                    userId:this.userId,                    url:this.addAdDate.url,                }).then(resp => {                    if (resp.data.code === 0) {                        this.$message.success(resp.data.message)//显示成功提示                        this.addAdFormVisible = false;//关闭窗口                        this.getAll();//刷新页面                        this.newAdId = resp.data.data.id                    } else {                        this.$message.error(resp.data.message)//显示失败提示                    }                })                this.handleAddCreativeUnit()            },            //添加【广告与单元关系】            handleAddCreativeUnit() {                for (var i = 0; i < this.multipleSelection.length; i++) {                    this.creativeUnits.push({                        creativeId: this.newAdId,                        unitId: this.multipleSelection[i].id                    })                }                //添加广告与单元关系                axios.post("/ad-sponsor/create/creativeUnit", {                    creativeUnits: this.creativeUnits                }).then(resp => {                    if (resp.data.code === 0) {                        this.$message.success(resp.data.message)//显示成功提示                        this.addAdFormVisible = false;//关闭窗口                        this.getAll();//刷新页面                    } else {                        this.$message.error(resp.data.message)//显示失败提示                    }                })            },            //重置表单            resetForm() {                this.addUnitKeywordDate = {}                this.addUnitDistrictDate = {}                this.addUnitInterestDate = {}                this.addAdDate = {}                this.creativeUnits = []//注意数组与对象的区别            },            //取消            cancel() {                this.addUnitKeywordFormVisible = false                this.addUnitDistrictFormVisible = false                this.addUnitInterestFormVisible = false                this.addAdFormVisible = false            },        }    })</script></html>